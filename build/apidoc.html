<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/andris9/inbox"

    >inbox (v1.1.59)</a>
</h1>
<h4>This is a work in progress IMAP client for node.js.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.inbox">module inbox</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient">
            function <span class="apidocSignatureSpan">inbox.</span>IMAPClient
            <span class="apidocSignatureSpan">(port, host, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.createConnection">
            function <span class="apidocSignatureSpan">inbox.</span>createConnection
            <span class="apidocSignatureSpan">(port, host, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.createXOAuthGenerator">
            function <span class="apidocSignatureSpan">inbox.</span>createXOAuthGenerator
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">inbox.</span>IMAPClient.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.inbox.IMAPClient">module inbox.IMAPClient</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.IMAPClient">
            function <span class="apidocSignatureSpan">inbox.</span>IMAPClient
            <span class="apidocSignatureSpan">(port, host, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.super_">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.inbox.IMAPClient.prototype">module inbox.IMAPClient.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._checkNewMail">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_checkNewMail
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._close">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._convertFromUTF7">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_convertFromUTF7
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._escapeString">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_escapeString
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._formatEnvelope">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_formatEnvelope
            <span class="apidocSignatureSpan">(envelopeData)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._formatEnvelopeAddress">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_formatEnvelopeAddress
            <span class="apidocSignatureSpan">(address)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handleGreetingTimeout">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handleGreetingTimeout
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerGreeting">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerGreeting
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedCapability">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedCapability
            <span class="apidocSignatureSpan">(status)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedCondstore">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedCondstore
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedId">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedId
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedLogin">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedLogin
            <span class="apidocSignatureSpan">(status)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedLsub">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedLsub
            <span class="apidocSignatureSpan">(xinfo, callback, status)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedSelect">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedSelect
            <span class="apidocSignatureSpan">(callback, status, params)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedStartTLS">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedStartTLS
            <span class="apidocSignatureSpan">(status)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedCapability">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedCapability
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedEnabled">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedEnabled
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedFetch">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedFetch
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedId">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedId
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedIdle">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedIdle
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedList">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedList
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedLsub">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedLsub
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedSearch">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedSearch
            <span class="apidocSignatureSpan">(list)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._idleTimeout">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_idleTimeout
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._init">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._onClose">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onClose
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._onConnect">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onConnect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._onData">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onData
            <span class="apidocSignatureSpan">(chunk)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._onEnd">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onEnd
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._onError">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onError
            <span class="apidocSignatureSpan">(error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._onServerLog">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onServerLog
            <span class="apidocSignatureSpan">(type, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._onServerResponse">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onServerResponse
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._parseBodystructure">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_parseBodystructure
            <span class="apidocSignatureSpan">(bs, parentBodypart)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._postAuth">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_postAuth
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._postCapability">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_postCapability
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._postReady">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_postReady
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._processCommandQueue">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_processCommandQueue
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._responseRouter">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_responseRouter
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype._send">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_send
            <span class="apidocSignatureSpan">(data, callback, prewrite)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.addFlags">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>addFlags
            <span class="apidocSignatureSpan">(uid, flags, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.addLabels">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>addLabels
            <span class="apidocSignatureSpan">(uid, labels, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.close">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.connect">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>connect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.copyMessage">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>copyMessage
            <span class="apidocSignatureSpan">(uid, destination, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.createMailbox">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>createMailbox
            <span class="apidocSignatureSpan">(path, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.createMessageStream">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>createMessageStream
            <span class="apidocSignatureSpan">(uid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.deleteMailbox">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>deleteMailbox
            <span class="apidocSignatureSpan">(path, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.deleteMessage">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>deleteMessage
            <span class="apidocSignatureSpan">(uid, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.fetchData">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>fetchData
            <span class="apidocSignatureSpan">(uid, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.fetchFlags">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>fetchFlags
            <span class="apidocSignatureSpan">(uid, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.getCurrentMailbox">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>getCurrentMailbox
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.getMailbox">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>getMailbox
            <span class="apidocSignatureSpan">(path, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.idle">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>idle
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.listFlags">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>listFlags
            <span class="apidocSignatureSpan">(from, limit, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.listMailboxes">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>listMailboxes
            <span class="apidocSignatureSpan">(path, all, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.listMessages">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>listMessages
            <span class="apidocSignatureSpan">(from, limit, extendedOptions, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.listMessagesByUID">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>listMessagesByUID
            <span class="apidocSignatureSpan">(from, to, extendedOptions, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.moveMessage">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>moveMessage
            <span class="apidocSignatureSpan">(uid, destination, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.openMailbox">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>openMailbox
            <span class="apidocSignatureSpan">(path, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.removeFlags">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>removeFlags
            <span class="apidocSignatureSpan">(uid, flags, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.removeLabels">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>removeLabels
            <span class="apidocSignatureSpan">(uid, labels, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.search">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>search
            <span class="apidocSignatureSpan">(query, isUid, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.storeMessage">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>storeMessage
            <span class="apidocSignatureSpan">(message, flags, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.updateFlags">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>updateFlags
            <span class="apidocSignatureSpan">(uid, flags, updateType, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.inbox.IMAPClient.prototype.updateLabels">
            function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>updateLabels
            <span class="apidocSignatureSpan">(uid, labels, updateType, callback)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>ENTER_IDLE</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>GREETING_TIMEOUT</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>IDLE_TIMEOUT</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>modes</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>states</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.inbox" id="apidoc.module.inbox">module inbox</a></h1>


    <h2>
        <a href="#apidoc.element.inbox.IMAPClient" id="apidoc.element.inbox.IMAPClient">
        function <span class="apidocSignatureSpan">inbox.</span>IMAPClient
        <span class="apidocSignatureSpan">(port, host, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IMAPClient(port, host, options){
    Stream.call(this);

<span class="apidocCodeCommentSpan">    /**
     * Make this stream writeable. For future reference only, currently not needed
     */
</span>    this.writable = true;

    /**
     * Make this stream readable. Should be on by default though
     */
    this.readable = true;

    /**
     * Options object for this instance
     */
    this.options = options || {};

    /**
     * Port to use for connecting to the server
     */
    this.port = port || (this.options.secureConnection ? 993 : 143);

    /**
     * Server hostname
     */
    this.host = host || &#x22;localhost&#x22;;

    /**
     * If set to true, print traffic between client and server to the console
     */
    this.debug = !!this.options.debug;

    /**
     * XOAuth2 token generator if XOAUTH2 auth is used
     * @private
     */
    this._xoauth2 = false;
    this._xoauth2RetryCount = 0;
    this._xoauth2UntaggedResponse = false;

    if(typeof this.options.auth &#x26;&#x26; typeof this.options.auth.XOAuth2){
        if(typeof this.options.auth.XOAuth2 == &#x22;object&#x22; &#x26;&#x26; typeof this.options.auth.XOAuth2.getToken == &#x22;function&#x22;){
            this._xoauth2 = this.options.auth.XOAuth2;
        }else if(typeof this.options.auth.XOAuth2 == &#x22;object&#x22;){
            if(!this.options.auth.XOAuth2.user &#x26;&#x26; this.options.auth.user){
                this.options.auth.XOAuth2.user = this.options.auth.user;
            }
            this._xoauth2 = xoauth2.createXOAuth2Generator(this.options.auth.XOAuth2);
        }
    }

    this._init();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.createConnection" id="apidoc.element.inbox.createConnection">
        function <span class="apidocSignatureSpan">inbox.</span>createConnection
        <span class="apidocSignatureSpan">(port, host, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function createConnection(port, host, options){
    return new IMAPClient(port, host, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```javascript
var inbox = require(&#x22;inbox&#x22;);
```
### Create new IMAP connection

Create connection object with
```javascript
inbox.<span class="apidocCodeKeywordSpan">createConnection</span>(port, host, options)
```

where

* **port** is the port to the server (defaults to 143 on non-secure and to 993 on secure connection)
* **host** is the hostname of the server
* **options** is an options object for auth etc.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.createXOAuthGenerator" id="apidoc.element.inbox.createXOAuthGenerator">
        function <span class="apidocSignatureSpan">inbox.</span>createXOAuthGenerator
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function createXOAuthGenerator(options){
    return new xoauth.XOAuthGenerator(options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Or for login with XOAUTH (see examples/xoauth-3lo.js and examples/xoauth-2lo.js)

```javascript
// 3-legged- oauth
var client = inbox.createConnection(false, &#x22;imap.gmail.com&#x22;, {
    secureConnection: true,
    auth:{
        XOAuthToken: inbox.<span class="apidocCodeKeywordSpan">createXOAuthGenerator</span>({
            user: &#x22;test.nodemailer@gmail.com&#x22;,
            token: &#x22;1/Gr2OVA2Ol64fNyjZCns-bkRau5eLisbdlEa_HSuTaEk&#x22;,
            tokenSecret: &#x22;ymFpseHtEnrIsuL8Ppbfnnk3&#x22;
        })
    }
});
```
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.inbox.IMAPClient" id="apidoc.module.inbox.IMAPClient">module inbox.IMAPClient</a></h1>


    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.IMAPClient" id="apidoc.element.inbox.IMAPClient.IMAPClient">
        function <span class="apidocSignatureSpan">inbox.</span>IMAPClient
        <span class="apidocSignatureSpan">(port, host, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function IMAPClient(port, host, options){
    Stream.call(this);

<span class="apidocCodeCommentSpan">    /**
     * Make this stream writeable. For future reference only, currently not needed
     */
</span>    this.writable = true;

    /**
     * Make this stream readable. Should be on by default though
     */
    this.readable = true;

    /**
     * Options object for this instance
     */
    this.options = options || {};

    /**
     * Port to use for connecting to the server
     */
    this.port = port || (this.options.secureConnection ? 993 : 143);

    /**
     * Server hostname
     */
    this.host = host || &#x22;localhost&#x22;;

    /**
     * If set to true, print traffic between client and server to the console
     */
    this.debug = !!this.options.debug;

    /**
     * XOAuth2 token generator if XOAUTH2 auth is used
     * @private
     */
    this._xoauth2 = false;
    this._xoauth2RetryCount = 0;
    this._xoauth2UntaggedResponse = false;

    if(typeof this.options.auth &#x26;&#x26; typeof this.options.auth.XOAuth2){
        if(typeof this.options.auth.XOAuth2 == &#x22;object&#x22; &#x26;&#x26; typeof this.options.auth.XOAuth2.getToken == &#x22;function&#x22;){
            this._xoauth2 = this.options.auth.XOAuth2;
        }else if(typeof this.options.auth.XOAuth2 == &#x22;object&#x22;){
            if(!this.options.auth.XOAuth2.user &#x26;&#x26; this.options.auth.user){
                this.options.auth.XOAuth2.user = this.options.auth.user;
            }
            this._xoauth2 = xoauth2.createXOAuth2Generator(this.options.auth.XOAuth2);
        }
    }

    this._init();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.super_" id="apidoc.element.inbox.IMAPClient.super_">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Stream() {
  EE.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.inbox.IMAPClient.prototype" id="apidoc.module.inbox.IMAPClient.prototype">module inbox.IMAPClient.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._checkNewMail" id="apidoc.element.inbox.IMAPClient.prototype._checkNewMail">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_checkNewMail
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_checkNewMail = function (){
    if(isNaN(this._selectedMailbox.UIDNext)){
        return;
    }

    this._send(&#x22;UID FETCH &#x22; + this._selectedMailbox.UIDNext + &#x22;:* (UID BODYSTRUCTURE FLAGS ENVELOPE INTERNALDATE&#x22; +
      (this._capabilities.indexOf(&#x22;X-GM-EXT-1&#x22;) &#x3e;= 0 ? &#x22; X-GM-LABELS X-GM-THRID&#x22; : &#x22;&#x22;) +
      (this._capabilities.indexOf(&#x22;CONDSTORE&#x22;) &#x3e;= 0 ? &#x22; MODSEQ&#x22; : &#x22;&#x22;) +
      &#x22;)&#x22;, (function(){
        this._checkForNewMail = false;
    }).bind(this),
    (function(){
        this._checkForNewMail = true;
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            }
        }

        if(!isNaN(data[1]) &#x26;&#x26; data[2] == &#x22;EXISTS&#x22;){
            if(this._selectedMailbox.count != Number(data[1])){
                this._selectedMailbox.count = Number(data[1]) || this._selectedMailbox.count || 0;
                if(this.idling || this.nooping){
                    this.<span class="apidocCodeKeywordSpan">_checkNewMail</span>();
                }
            }
            return;
        }

    }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._close" id="apidoc.element.inbox.IMAPClient.prototype._close">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_close = function (){
    if(!this._connection){
        return;
    }

    clearTimeout(this._shouldIdleTimer);
    clearTimeout(this._idleTimer);
    clearTimeout(this._greetingTimeout);

    var socket = this._connection.socket || this._connection;

    if(socket &#x26;&#x26; !socket.destroyed){
        socket.destroy();
    }

    if(this.debug){
        console.log(&#x22;Connection to server closed&#x22;);
    }

    this._connection = false;
    this._commandQueue = [];
    this.emit(&#x22;close&#x22;);

    this.removeAllListeners();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @event
 */
IMAPClient.prototype._onClose = function(){
    if(this.debug){
        console.log(&#x22;EVENT: CLOSE&#x22;);
    }

    this.<span class="apidocCodeKeywordSpan">_close</span>();
};

/**
 * &#x27;end&#x27; event when disconnected from the server
 * @event
 */
IMAPClient.prototype._onEnd = function(){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._convertFromUTF7" id="apidoc.element.inbox.IMAPClient.prototype._convertFromUTF7">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_convertFromUTF7
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_convertFromUTF7 = function (str){
    return utf7.decode((str || &#x22;&#x22;).toString());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
IMAPClient.prototype._handlerUntaggedList = function(list){
var tags = list.shift() || [],
    delimiter = list.shift() || this._mailboxDelimiter,
    path = (list.shift() || &#x22;&#x22;).substr(this._rootPath.length),
    name = delimiter?path.split(delimiter).pop():path,
    mailbox = {
        name: this.<span class="apidocCodeKeywordSpan">_convertFromUTF7</span>(name),
        delimiter: delimiter,
        path: path,
        tags: tags
    };

this._mailboxDelimiter = delimiter;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._escapeString" id="apidoc.element.inbox.IMAPClient.prototype._escapeString">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_escapeString
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_escapeString = function (str){
    return &#x22;\&#x22;&#x22; + (str || &#x22;&#x22;).toString().replace(/([&#x22;\\])/g, &#x22;\\$1&#x22;).replace(/[\r\n]/g, &#x22; &#x22;) + &#x22;\&#x22;&#x22;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if(this.options.clientId){
    Object.keys(this.options.clientId).forEach((function(key){
        clientData[key] = this.options.clientId[key];
    }).bind(this));
}

clientData = Object.keys(clientData).map((function(key){
        return this.<span class="apidocCodeKeywordSpan">_escapeString</span>(key) + &#x22; &#x22; + this._escapeString(clientData
[key]);
    }).bind(this)).join(&#x22; &#x22;);

if(this._capabilities.indexOf(&#x22;ID&#x22;)&#x3e;=0){
    if(clientData.length){
        this._send(&#x22;ID (&#x22; + clientData + &#x22;)&#x22;, this._handlerTaggedId.bind(this));
    }else{
        this._send(&#x22;ID NIL&#x22;, this._handlerTaggedId.bind(this));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._formatEnvelope" id="apidoc.element.inbox.IMAPClient.prototype._formatEnvelope">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_formatEnvelope
        <span class="apidocSignatureSpan">(envelopeData)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_formatEnvelope = function (envelopeData){

    if(!Array.isArray(envelopeData)){
        return null;
    }

    var dataObject = {}, lastKey = false, i, len;

    for(i=0, len = envelopeData.length; i&#x3c;len; i++){
        if(!lastKey){
            lastKey = (envelopeData[i] &#x26;&#x26; envelopeData[i].value || envelopeData[i] || &#x22;&#x22;).toString();
        }else{
            dataObject[lastKey] = envelopeData[i];
            lastKey = false;
        }
    }

    var message = {
        UIDValidity: this._selectedMailbox.UIDValidity,
        path: this._selectedMailbox.path
    };

    if(dataObject.UID){
        message.UID = Number(dataObject.UID) || 0;
    }

    if(dataObject.FLAGS){
        message.flags = dataObject.FLAGS || [];
    }

    if(dataObject.INTERNALDATE){
        message.internalDate = new Date(dataObject.INTERNALDATE || Date.now());
    }

    if(dataObject[&#x22;X-GM-THRID&#x22;]){
        message.xGMThreadId = dataObject[&#x22;X-GM-THRID&#x22;];
    }

    if(dataObject.MODSEQ){
        message.modSeq = Number(dataObject.MODSEQ);
    }

    if (dataObject[&#x22;RFC822.HEADER&#x22;]){

        var startIndex = dataObject[&#x22;RFC822.HEADER&#x22;].indexOf(&#x27;References:&#x27;) + &#x27;References:&#x27;.length;
        if (startIndex != -1){
            var endIndex = dataObject[&#x22;RFC822.HEADER&#x22;].indexOf(&#x27;:&#x27;, startIndex);
            message.references = dataObject[&#x22;RFC822.HEADER&#x22;].substring(startIndex, endIndex).match(/&#x3c;(.*?)&#x3e;+/igm);
        }

        var temp = dataObject[&#x22;RFC822.HEADER&#x22;].match(/(X-Originating-IP:).+?]/igm)
        if (temp){
            message.xOriginatingIP = temp[0].substring(&#x27;X-Originating-IP:&#x27;.length).trim().replace(/(\[|\])/g, &#x27;&#x27;);
        }
    }

    if(dataObject.BODYSTRUCTURE){
        message.bodystructure = this._parseBodystructure(dataObject.BODYSTRUCTURE);
    }

    var messageTypes = [],
        messageTypeMap = {
            &#x22;Drafts&#x22;: &#x22;Draft&#x22;,
            &#x22;Flagged&#x22;: &#x22;Starred&#x22;,
            &#x22;Spam&#x22;: &#x22;Junk&#x22;
        },
        messageTypePreferenceOrder = [&#x22;Sent&#x22;, &#x22;Draft&#x22;, &#x22;Starred&#x22;, &#x22;Junk&#x22;, &#x22;Trash&#x22;];

    if(dataObject[&#x22;X-GM-LABELS&#x22;]){
        message.labels = [].concat(dataObject[&#x22;X-GM-LABELS&#x22;] || []);
        message.folders = (dataObject[&#x22;X-GM-LABELS&#x22;] || []).map((function(label){
            var type;

            if(label &#x26;&#x26; typeof label == &#x22;object&#x22; &#x26;&#x26; label.params){
                label = label.params.map((function(localLabel){
                    localLabel = this._convertFromUTF7(localLabel || &#x22;&#x22;);
                    messageTypes.push(localLabel);
                    return localLabel;
                }).bind(this)).join(this._mailboxDelimiter);
            }

            label = this._convertFromUTF7(label || &#x22;&#x22;);

            // trim delimiters
            if(label.charAt(0) == this._mailboxDelimiter){
                label = label.substr(1);
            }
            if(label.charAt(label.length-1) == this._mailboxDelimiter){
                label = label.substr(0, label.length-1);
            }

            if(label.search(this._mailboxDelimiter) &#x3e; 0){ // ignore the first char
                return label.split(this._mailboxDelimiter).map(function(localLabel){
                    var localType;
                    if((localType = detectMailboxType(localLabel)) != &#x22;Normal&#x22;){
                        messageTypes.push(localType);
                        return localLabel;
                    }else{
                        return localLabel;
                    }
                });
            }

            // Convert name to canonized version
            if((type = detectMailboxType(label)) != &#x22;Normal&#x22;){
                // Add flag indicator
                messageTypes.push(type);
                return type;
            }

            // Convert tags to names
            if(label.charAt(0)==&#x22;\\&#x22; &#x26;&#x26; label != &#x22;\\Important&#x22;){
                label = label.substr(1);
                messageTypes.push(label);
            }

            return label;
        }).bind(this));
    }else{
        message.folders = (this._selectedMailbox.path || &#x22;&#x22;).split(this._mailboxDelimiter) || [];
        if(message.folders.length &#x3e; 1){
            message ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
 * Handle untagged FETCH responses, these have data about individual messages.
 *
 * @param {Array} list Params about a message
 */
IMAPClient.prototype._handlerUntaggedFetch = function(list){
var envelope = (list || [])[3] || [],
    envelopeData = this.<span class="apidocCodeKeywordSpan">_formatEnvelope</span>(envelope),
    nextUID = Number(this._selectedMailbox.UIDNext) || 0,
    currentUID = Number(envelopeData.UID) || 0;

if(!nextUID || nextUID &#x3c;= currentUID){
    this._selectedMailbox.UIDNext = currentUID + 1;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._formatEnvelopeAddress" id="apidoc.element.inbox.IMAPClient.prototype._formatEnvelopeAddress">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_formatEnvelopeAddress
        <span class="apidocSignatureSpan">(address)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_formatEnvelopeAddress = function (address){
    address = [].concat(address || []);
    var name = address[0] || &#x22;&#x22;,
        email = (address[2] || &#x22;&#x22;) + &#x22;@&#x22; + (address[3] || &#x22;&#x22;);

    if(email == &#x22;@&#x22;){
        email = &#x22;&#x22;;
    }

    return {
        name: (name || email).replace(/\=\?[^?]+\?[QqBb]\?[^?]*\?=/g,
                function(mimeWord){
                    return mimelib.decodeMimeWord(mimeWord);
                }),
        address: email
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handleGreetingTimeout" id="apidoc.element.inbox.IMAPClient.prototype._handleGreetingTimeout">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handleGreetingTimeout
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handleGreetingTimeout = function (){
    var error = new Error(&#x22;Timeout waiting for a greeting&#x22;);
    error.errorType = &#x22;TimeoutError&#x22;;
    this.emit(&#x22;error&#x22;, error);
    this._close();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerGreeting" id="apidoc.element.inbox.IMAPClient.prototype._handlerGreeting">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerGreeting
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerGreeting = function (data){
    clearTimeout(this._greetingTimeout);

    if(!data || !Array.isArray(data)){
        throw new Error(&#x22;Invalid input&#x22;);
    }

    if(data[0] != &#x22;*&#x22; &#x26;&#x26; data[1] != &#x22;OK&#x22;){
        var error = new Error(&#x22;Bad greeting from the server&#x22;);
        error.errorType = &#x22;ProtocolError&#x22;;
        error.errorLog = this._log.slice(0, this._logLength);
        this.emit(&#x22;error&#x22;, error);
        this._close();
        return;
    }

    this._currentState = this.states.PREAUTH;
    this._currentHandler = this._responseRouter;

    this._send(&#x22;CAPABILITY&#x22;, this._handlerTaggedCapability.bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedCapability" id="apidoc.element.inbox.IMAPClient.prototype._handlerTaggedCapability">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedCapability
        <span class="apidocSignatureSpan">(status)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerTaggedCapability = function (status){
    if(status == &#x22;OK&#x22;){
        if(!this._secureMode &#x26;&#x26; this._capabilities.indexOf(&#x22;STARTTLS&#x22;)&#x3e;=0){
            this._send(&#x22;STARTTLS&#x22;, this._handlerTaggedStartTLS.bind(this));
            return;
        }

        this._postCapability();
    }else{
        var error = new Error(&#x22;Invalid capability response&#x22;);
        error.errorType = &#x22;ProtocolError&#x22;;
        error.errorLog = this._log.slice(0, this._logLength);
        this.emit(&#x22;error&#x22;, error);
        this._close();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedCondstore" id="apidoc.element.inbox.IMAPClient.prototype._handlerTaggedCondstore">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedCondstore
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerTaggedCondstore = function (){
    var clientData = {};

    if(this.options.clientId){
        Object.keys(this.options.clientId).forEach((function(key){
            clientData[key] = this.options.clientId[key];
        }).bind(this));
    }

    clientData = Object.keys(clientData).map((function(key){
            return this._escapeString(key) + &#x22; &#x22; + this._escapeString(clientData[key]);
        }).bind(this)).join(&#x22; &#x22;);

    if(this._capabilities.indexOf(&#x22;ID&#x22;)&#x3e;=0){
        if(clientData.length){
            this._send(&#x22;ID (&#x22; + clientData + &#x22;)&#x22;, this._handlerTaggedId.bind(this));
        }else{
            this._send(&#x22;ID NIL&#x22;, this._handlerTaggedId.bind(this));
        }
    }else{
        this._postReady();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Run when user is successfully entered AUTH state
*/
IMAPClient.prototype._postAuth = function(){
   if(this._capabilities.indexOf(&#x22;CONDSTORE&#x22;)&#x3e;=0){
       this._send(&#x22;ENABLE CONDSTORE&#x22;, this._handlerTaggedCondstore.bind(this));
   }else{
       this.<span class="apidocCodeKeywordSpan">_handlerTaggedCondstore</span>(&#x22;OK&#x22;);
   }
};

/**
* Run it when all the required jobs for setting up an authorized connection
* are completed. Emit &#x27;connect&#x27; event.
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedId" id="apidoc.element.inbox.IMAPClient.prototype._handlerTaggedId">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedId
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerTaggedId = function (){
    this._postReady();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedLogin" id="apidoc.element.inbox.IMAPClient.prototype._handlerTaggedLogin">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedLogin
        <span class="apidocSignatureSpan">(status)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerTaggedLogin = function (status){
    if(status == &#x22;OK&#x22;){
        this._xoauth2RetryCount = 0;
        this._xoauth2UntaggedResponse  = false;
        this._currentState = this.states.AUTH;
        if(!this._updatedCapabilities){
            this._send(&#x22;CAPABILITY&#x22;, this._handlerTaggedCapability.bind(this));
        }else{
            this._postAuth();
        }
    }else{
        if(this._xoauth2 &#x26;&#x26; this._xoauth2UntaggedResponse &#x26;&#x26; this._xoauth2RetryCount &#x26;&#x26; this._xoauth2RetryCount &#x3c; 3){
            this._xoauth2.generateToken((function(err){
                var error;
                if(err){
                    if(typeof err != &#x22;object&#x22;){
                        error = new Error(err.toString());
                    }else{
                       error = err;
                    }
                    error.errorType = &#x22;XOAUTH2Error&#x22;;
                    error.errorLog = this._log.slice(0, this._logLength);
                    this.emit(&#x22;error&#x22;, error);
                    return;
                }
                this._postCapability();
            }).bind(this));
        }else{
            var error = new Error(&#x22;Authentication failed&#x22;);
            error.errorType = &#x22;AuthenticationError&#x22;;
            error.errorLog = this._log.slice(0, this._logLength);
            this.emit(&#x22;error&#x22;, error);
            this._close();
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedLsub" id="apidoc.element.inbox.IMAPClient.prototype._handlerTaggedLsub">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedLsub
        <span class="apidocSignatureSpan">(xinfo, callback, status)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerTaggedLsub = function (xinfo, callback, status){
    if(status != &#x22;OK&#x22;){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;Mailbox listing failed&#x22;));
        }
        return;
    }

    var curXinfo, curName;

    for(var i=0, len = xinfo.length; i&#x3c;len; i++){

        curXinfo = xinfo[i];
        curXinfo.tags = curXinfo.tags || [];

        curName = curXinfo.name || &#x22;&#x22;;
        if(curXinfo.tags.indexOf(&#x22;\\Inbox&#x22;)&#x3e;=0){
            curName = &#x22;INBOX&#x22;;
        }

        for(var j=0, jlen = this._mailboxList.length; j&#x3c;jlen; j++){
            if(curName == this._mailboxList[j].name){

                this._mailboxList[j].name = curXinfo.name || this._mailboxList[j].name || &#x22;&#x22;;
                this._mailboxList[j].tags = curXinfo.tags;

                if(curXinfo.tags.indexOf(&#x22;\\Noselect&#x22;)&#x3e;=0){
                    this._mailboxList[j].disabled = true;
                }

                if(curXinfo.tags.indexOf(&#x22;\\Inbox&#x22;)&#x3e;=0){
                    this._mailboxList[j].type = &#x22;Inbox&#x22;;
                }else if(curXinfo.tags.indexOf(&#x22;\\All&#x22;)&#x3e;=0 || curXinfo.tags.indexOf(&#x22;\\AllMail&#x22;)&#x3e;=0){
                    this._mailboxList[j].type = &#x22;All Mail&#x22;;
                }else if(curXinfo.tags.indexOf(&#x22;\\Archive&#x22;)&#x3e;=0){
                    this._mailboxList[j].type = &#x22;Archive&#x22;;
                }else if(curXinfo.tags.indexOf(&#x22;\\Drafts&#x22;)&#x3e;=0){
                    this._mailboxList[j].type = &#x22;Drafts&#x22;;
                }else if(curXinfo.tags.indexOf(&#x22;\\Sent&#x22;)&#x3e;=0){
                    this._mailboxList[j].type = &#x22;Sent&#x22;;
                }else if(curXinfo.tags.indexOf(&#x22;\\Junk&#x22;)&#x3e;=0 || curXinfo.tags.indexOf(&#x22;\\Spam&#x22;)&#x3e;=0){
                    this._mailboxList[j].type = &#x22;Junk&#x22;;
                }else if(curXinfo.tags.indexOf(&#x22;\\Flagged&#x22;)&#x3e;=0 || curXinfo.tags.indexOf(&#x22;\\Starred&#x22;)&#x3e;=0){
                    this._mailboxList[j].type = &#x22;Flagged&#x22;;
                }else if(curXinfo.tags.indexOf(&#x22;\\Important&#x22;)&#x3e;=0){
                    this._mailboxList[j].type = &#x22;Important&#x22;;
                }else if(curXinfo.tags.indexOf(&#x22;\\Trash&#x22;)&#x3e;=0){
                    this._mailboxList[j].type = &#x22;Trash&#x22;;
                }

                break;
            }
        }
    }

    if(typeof callback == &#x22;function&#x22;){
        callback(null, this._mailboxList);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    xinfo = xinfo || [];

    this.client._send(&#x22;LSUB &#x22;+this.client._escapeString(this.client._rootPath)+&#x22; &#x22;+path,
        (function(status){
            if(!this.client._mailboxList.length){
                this.client._mailboxList = [].concat(xinfo);
            }
            this.client.<span class="apidocCodeKeywordSpan">_handlerTaggedLsub</span>(xinfo, callback, status);
        }).bind(this),
        (function(){
            this.client._mailboxList = [];
        }).bind(this));
};

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedSelect" id="apidoc.element.inbox.IMAPClient.prototype._handlerTaggedSelect">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedSelect
        <span class="apidocSignatureSpan">(callback, status, params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerTaggedSelect = function (callback, status, params){
    if(status == &#x22;OK&#x22;){
        this._currentState = this.states.SELECTED;

        if(Array.isArray(params) &#x26;&#x26; params[0] &#x26;&#x26; params[0].params){
            if(params[0].params[0] == &#x22;READ-WRITE&#x22;){
                this._selectedMailbox.readOnly = false;
            }else if(params[0].params[0] == &#x22;READ-ONLY&#x22;){
                this._selectedMailbox.readOnly = true;
            }
        }

        clearTimeout(this._shouldIdleTimer);
        clearTimeout(this._idleTimer);
        this._shouldIdleTimer = setTimeout(this.idle.bind(this), this.ENTER_IDLE);

        if(typeof callback == &#x22;function&#x22;){
            callback(null, this._selectedMailbox);
        }else{
            this.emit(&#x22;mailbox&#x22;, this._selectedMailbox);
        }
    }else{
        var error = new Error(&#x22;Mailbox select failed&#x22;);
        error.errorType = &#x22;MailboxError&#x22;;
        error.errorLog = this._log.slice(0, this._logLength);
        if(typeof callback == &#x22;function&#x22;){
            callback(error);
        }else{
            this.emit(&#x22;error&#x22;, error);
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerTaggedStartTLS" id="apidoc.element.inbox.IMAPClient.prototype._handlerTaggedStartTLS">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerTaggedStartTLS
        <span class="apidocSignatureSpan">(status)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerTaggedStartTLS = function (status){
    if(status == &#x22;OK&#x22;){
        this._ignoreData = true;
        starttls(this._connection, (function(socket){

            this._connection = socket;
            this._ignoreData = false;
            this._secureMode = true;
            this._connection.on(&#x22;data&#x22;, this._onData.bind(this));

            if(&#x22;setKeepAlive&#x22; in this._connection){
                this._connection.setKeepAlive(true);
            }else if(this._connection.socket &#x26;&#x26; &#x22;setKeepAlive&#x22; in this._connection.socket){
                this._connection.socket.setKeepAlive(true); // secure connection
            }

            this._send(&#x22;CAPABILITY&#x22;, this._handlerTaggedCapability.bind(this));
        }).bind(this));
    }else{
        var error = new Error(&#x22;Invalid starttls response&#x22;);
        error.errorType = &#x22;TLSError&#x22;;
        error.errorLog = this._log.slice(0, this._logLength);
        this.emit(&#x22;error&#x22;, error);
        this._close();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedCapability" id="apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedCapability">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedCapability
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerUntaggedCapability = function (list){
    this._updatedCapabilities = true;
    this._capabilities = list;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this._literalHandler = null;
}

// handle untagged commands (tagged with *)
if(data[0]==&#x22;*&#x22;){
    switch(data[1]){
        case &#x22;CAPABILITY&#x22;:
            this.<span class="apidocCodeKeywordSpan">_handlerUntaggedCapability</span>(data.slice(2));
            return;
        case &#x22;ID&#x22;:
            this._handlerUntaggedId(data.slice(2));
            return;
        case &#x22;ENABLED&#x22;:
            this._handlerUntaggedEnabled(data.slice(2));
            return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedEnabled" id="apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedEnabled">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedEnabled
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerUntaggedEnabled = function (list){
    list = [].concat(list || []);

    if(list[0] == &#x22;CONDSTORE&#x22;){
        this._condstoreEnabled = true;
    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
case &#x22;CAPABILITY&#x22;:
    this._handlerUntaggedCapability(data.slice(2));
    return;
case &#x22;ID&#x22;:
    this._handlerUntaggedId(data.slice(2));
    return;
case &#x22;ENABLED&#x22;:
    this.<span class="apidocCodeKeywordSpan">_handlerUntaggedEnabled</span>(data.slice(2));
    return;
case &#x22;FLAGS&#x22;:
    this._selectedMailbox.flags = data[2] || [];
    return;
case &#x22;SEARCH&#x22;:
    this._handlerUntaggedSearch(data.slice(2));
    return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedFetch" id="apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedFetch">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedFetch
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerUntaggedFetch = function (list){
    var envelope = (list || [])[3] || [],
        envelopeData = this._formatEnvelope(envelope),
        nextUID = Number(this._selectedMailbox.UIDNext) || 0,
        currentUID = Number(envelopeData.UID) || 0;

    if(!nextUID || nextUID &#x3c;= currentUID){
        this._selectedMailbox.UIDNext = currentUID + 1;
    }

    if(this._collectMailList){
        this._mailList.push(envelopeData);
    }

    // emit as new message
    if(nextUID &#x26;&#x26; nextUID &#x3c;= currentUID &#x26;&#x26; this._checkForNewMail){
        this.emit(&#x22;new&#x22;, envelopeData);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                }
            }
        }
        return;
}

if(!isNaN(data[1]) &#x26;&#x26; data[2] == &#x22;FETCH&#x22;){
    this.<span class="apidocCodeKeywordSpan">_handlerUntaggedFetch</span>(data);
    return;
}

if(!isNaN(data[1]) &#x26;&#x26; data[2] == &#x22;EXPUNGE&#x22;){
    if(this._selectedMailbox.count){
        this._selectedMailbox.count--;
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedId" id="apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedId">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedId
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerUntaggedId = function (list){
    list = (list || [])[0] || [];
    var key;
    for(var i=0, len = list.length; i&#x3c;len; i++){
        if(i % 2 === 0){
            key = list[i];
        }else{
            this._serverId[key] = list[i];
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// handle untagged commands (tagged with *)
if(data[0]==&#x22;*&#x22;){
    switch(data[1]){
        case &#x22;CAPABILITY&#x22;:
            this._handlerUntaggedCapability(data.slice(2));
            return;
        case &#x22;ID&#x22;:
            this.<span class="apidocCodeKeywordSpan">_handlerUntaggedId</span>(data.slice(2));
            return;
        case &#x22;ENABLED&#x22;:
            this._handlerUntaggedEnabled(data.slice(2));
            return;
        case &#x22;FLAGS&#x22;:
            this._selectedMailbox.flags = data[2] || [];
            return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedIdle" id="apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedIdle">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedIdle
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerUntaggedIdle = function (){
    this._idleWait = false;
    this.idling = true;
    if(this._shouldCheckOnIdle){
        this._shouldCheckOnIdle = false;
        this._checkNewMail();
    }
    this._processCommandQueue();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this._currentRequest.callback(data[1], data.slice(2));
    return;
}

// handle commands tagged with +
if(data[0]==&#x22;+&#x22;){
    if(this._idleWait){
        this.<span class="apidocCodeKeywordSpan">_handlerUntaggedIdle</span>();
    }

    if(this._literalHandler){
        this._literalHandler(data.slice(1));
    }
}else if(this._literalHandler){
    this._literalHandler = null;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedList" id="apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedList">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedList
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerUntaggedList = function (list){
    var tags = list.shift() || [],
        delimiter = list.shift() || this._mailboxDelimiter,
        path = (list.shift() || &#x22;&#x22;).substr(this._rootPath.length),
        name = delimiter?path.split(delimiter).pop():path,
        mailbox = {
            name: this._convertFromUTF7(name),
            delimiter: delimiter,
            path: path,
            tags: tags
        };

    this._mailboxDelimiter = delimiter;

    this._mailboxList.push(mailbox);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this._selectedMailbox.flags = data[2] || [];
    return;
case &#x22;SEARCH&#x22;:
    this._handlerUntaggedSearch(data.slice(2));
    return;
case &#x22;XLIST&#x22;:
case &#x22;LIST&#x22;:
    this.<span class="apidocCodeKeywordSpan">_handlerUntaggedList</span>(data.slice(2));
    return;
case &#x22;LSUB&#x22;:
    this._handlerUntaggedLsub(data.slice(2));
    return;
case &#x22;OK&#x22;:
    if(typeof data[2] == &#x22;object&#x22;){
        if(Array.isArray(data[2].params)){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedLsub" id="apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedLsub">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedLsub
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerUntaggedLsub = function (list){
    var tags = list.shift() || [],
        delimiter = list.shift() || this._mailboxDelimiter,
        path = (list.shift() || &#x22;&#x22;).substr(this._rootPath.length),
        name = delimiter?path.split(delimiter).pop():path,
        mailbox = new Mailbox({
            client: this,
            path: path,
            name: this._convertFromUTF7(name),
            delimiter: delimiter
        });

    if(tags.indexOf(&#x22;\\HasChildren&#x22;)&#x3e;=0){
        mailbox.hasChildren = true;
    }

    if(name == &#x22;INBOX&#x22;){
        mailbox.type=&#x22;Inbox&#x22;;
    }

    this._mailboxList.push(mailbox);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this._handlerUntaggedSearch(data.slice(2));
    return;
case &#x22;XLIST&#x22;:
case &#x22;LIST&#x22;:
    this._handlerUntaggedList(data.slice(2));
    return;
case &#x22;LSUB&#x22;:
    this.<span class="apidocCodeKeywordSpan">_handlerUntaggedLsub</span>(data.slice(2));
    return;
case &#x22;OK&#x22;:
    if(typeof data[2] == &#x22;object&#x22;){
        if(Array.isArray(data[2].params)){
            if(data[2].params[0] == &#x22;UIDVALIDITY&#x22;){
                this._selectedMailbox.UIDValidity = data[2].params[1];
                return;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedSearch" id="apidoc.element.inbox.IMAPClient.prototype._handlerUntaggedSearch">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_handlerUntaggedSearch
        <span class="apidocSignatureSpan">(list)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handlerUntaggedSearch = function (list){
    if(this._collectMailList){
        this._mailList = this._mailList.concat(list.map(Number));
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
case &#x22;ENABLED&#x22;:
    this._handlerUntaggedEnabled(data.slice(2));
    return;
case &#x22;FLAGS&#x22;:
    this._selectedMailbox.flags = data[2] || [];
    return;
case &#x22;SEARCH&#x22;:
    this.<span class="apidocCodeKeywordSpan">_handlerUntaggedSearch</span>(data.slice(2));
    return;
case &#x22;XLIST&#x22;:
case &#x22;LIST&#x22;:
    this._handlerUntaggedList(data.slice(2));
    return;
case &#x22;LSUB&#x22;:
    this._handlerUntaggedLsub(data.slice(2));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._idleTimeout" id="apidoc.element.inbox.IMAPClient.prototype._idleTimeout">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_idleTimeout
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_idleTimeout = function (){
    this._send(&#x22;NOOP&#x22;, this.idle.bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._init" id="apidoc.element.inbox.IMAPClient.prototype._init">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_init = function (){

<span class="apidocCodeCommentSpan">    /**
     * Should the connection be over TLS or NET
     */
</span>    this.options.secureConnection = !!this.options.secureConnection;

    /**
     * Authentication details
     */
    this.options.auth = this.options.auth || {user: &#x22;&#x22;, pass:&#x22;&#x22;};

    /**
     * Connection socket to the server
     */
    this._connection = false;

    /**
     * Is the connection currently in secure mode, changes with STARTTLS
     */
    this._secureMode = !!this.options.secureConnection;

    /**
     * Current protocol state.
     */
    this._currentState = this.states.NONE;

    /**
     * Current stream mode for incoming data
     */
    this._currentMode = this.modes.COMMAND;

    /**
     * Expected remaining data length on stream data mode
     */
    this._expectedDataLength = 0;

    /**
     * Data that was not part of the last command
     */
    this._remainder = &#x22;&#x22;;

    /**
     * Counter for generating unique command tags
     */
    this._tagCounter = 0;

    /**
     * Currently active command
     */
    this._currentRequest = false;

    /**
     * Unprocessed commands
     */
    this._commandQueue = [];

    /**
     * Server capabilities
     */
    this._capabilities = [];

    /**
     * Are the capabilities updated
     */
    this._updatedCapabilities = false;

    /**
     * Currently in idle
     */
    this.idling = false;

    /**
     * Currently &#x22;nooping&#x22; when idle not available
     */
    this.nooping = false;

    /**
     * Waiting for idle start after issuing IDLE command
     */
    this._idleWait = false;

    /**
     * Waiting for the idle to end
     */
    this._idleEnd = false;

    /**
     * Timer to run NOOP when in idle
     */
    this._idleTimer = false;

    /**
     * Timer for entering idle mode after other commands
     */
    this._shouldIdleTimer = true;

    /**
     * If true check mail before entering idle
     */
    this._shouldCheckOnIdle = false;

    /**
     * Timeout to wait for a successful greeting from the server
     */
    this._greetingTimeout = false;

    /**
     * Server ID
     */
     this._serverId = {};

    /**
     * Should the FETCH responses collected into an array
     */
    this._collectMailList = false;

    /**
     * An array of collected FETCH responses
     */
    this._mailList = [];

    /**
     * If set to true emit FETCH responses as new emails
     */
    this._checkForNewMail = false;

    /**
     * Currently selected mailbox data
     */
    this._selectedMailbox = {};

    /**
     * Currently streaming possible literal values
     */
    this._literalStreaming = false;

    /**
     * Message Stream object for streaming requested messages
     */
    this._messageStream = false;

    /**
     * Literal handler
     */
    this._literalHandler = false;

    /**
     * Personal mailbox root
     */
    this._rootPath = &#x22;&#x22;;

    /**
     * Delimiter for mailbox hierarchy
     */
    this._mailboxDelimiter = &#x22;/&#x22;;

    /**
     * Default INBOX name
     */
    this._inboxName = &#x22;INBOX&#x22;;

    /**
     * Default Sent folder name
     */
    this._outgoingName = this.options.outgoingName || &#x22;&#x22;;

    /**
     * Active mailbox list
     */
    this._mailboxList = [];

    /**
     * Is CONDSTORE enabled or not
     */
    this._condstoreEnabled = false;

    /**
     * Ignore all incoming data while in TLS negotiations
     */
    this._ignoreData = false;

    /**
     * Keep IMAP log for error trace
     */
    this._log = [];

    /**
     * IMAP log length in lines
     */
    this._logLength = 10;

    /**
     * Root mailbox
     */
    this._rootMailbox = new Mailbox({client: this});

    /**
     * Lineparser object to feed the incoming data to
     */
    this.lineparser = new IMAPLineParser();

    /**
     * Initially send the incoming data to greeting handler
     */
    this._currentHandler = this._handlerGreeting;

    this.lineparser.on(&#x22;line&#x22;, this._onServerResponse.bind(this));
    this.lineparser.on(&#x22;log&#x22;, this._onServerLog.bind(this, &#x22;S&#x22;));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            if(!this.options.auth.XOAuth2.user &#x26;&#x26; this.options.auth.user){
                this.options.auth.XOAuth2.user = this.options.auth.user;
            }
            this._xoauth2 = xoauth2.createXOAuth2Generator(this.options.auth.XOAuth2);
        }
    }

    this.<span class="apidocCodeKeywordSpan">_init</span>();
}
utillib.inherits(IMAPClient, Stream);

/**
 * States constants for the client FSM.
 */
IMAPClient.prototype.states = {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._onClose" id="apidoc.element.inbox.IMAPClient.prototype._onClose">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onClose
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onClose = function (){
    if(this.debug){
        console.log(&#x22;EVENT: CLOSE&#x22;);
    }

    this._close();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._onConnect" id="apidoc.element.inbox.IMAPClient.prototype._onConnect">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onConnect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onConnect = function (){

    if(this.debug){
        console.log(&#x22;Connection to server opened&#x22;);
    }

    if(&#x22;setKeepAlive&#x22; in this._connection){
        this._connection.setKeepAlive(true);
    }else if(this._connection.socket &#x26;&#x26; &#x22;setKeepAlive&#x22; in this._connection.socket){
        this._connection.socket.setKeepAlive(true); // secure connection
    }

    this._connection.on(&#x22;data&#x22;, this._onData.bind(this));
    this._connection.on(&#x22;close&#x22;, this._onClose.bind(this));
    this._connection.on(&#x22;end&#x22;, this._onEnd.bind(this));

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._onData" id="apidoc.element.inbox.IMAPClient.prototype._onData">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onData
        <span class="apidocSignatureSpan">(chunk)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onData = function (chunk){
    if(this._ignoreData){
        // TLS negotiations going on, ignore everything received
        return;
    }

    var data = chunk &#x26;&#x26; chunk.toString(&#x22;binary&#x22;) || &#x22;&#x22;,
        line, match;

    if(this._remainder){
        data = this._remainder + data;
        this._remainder = &#x22;&#x22;;
    }

    if(this._currentMode == this.modes.DATA){
        if(this._expectedDataLength &#x3c;= data.length){

            if(this._expectedDataLength){

                if(!this._literalStreaming){
                    this.lineparser.writeLiteral(data.substr(0, this._expectedDataLength));
                }else{
                    this._messageStream.emit(&#x22;data&#x22;, new Buffer(data.substr(0, this._expectedDataLength), &#x22;binary&#x22;));
                }

                this._remainder = data.substr(this._expectedDataLength);
                this._expectedDataLength = 0;
            }else{
                this._remainder = data;
            }

            this._currentMode = this.modes.COMMAND;

            return this._onData(); // rerun with the remainder
        }else{

            if(!this._literalStreaming){
                this.lineparser.writeLiteral(data);
            }else{
                this._messageStream.emit(&#x22;data&#x22;, new Buffer(data, &#x22;binary&#x22;));
            }

            this._expectedDataLength -= data.length;
            return;
        }
    }

    if(this._currentMode == this.modes.COMMAND){
        if((match = data.match(/\r?\n/))){ // find the line ending
            line = data.substr(0, match.index);
            this._remainder = data.substr(match.index + match[0].length) || &#x22;&#x22;;

            if(this.debug){
                console.log(&#x22;SERVER: &#x22;+line);
            }

            // check if the line ends with a literal notion
            if((match = line.match(/\{(\d+)\}\s*$/))){
                this._expectedDataLength = Number(match[1]);
                this.lineparser.write(line);

                this._currentMode = this.modes.DATA;

                if(this._literalStreaming){
                    this.lineparser.writeLiteral(&#x22;&#x22;); // create empty literal object
                }
            }else{
                this.lineparser.end(line);
            }

            if(this._remainder){
                return this._onData(); // rerun with the remainder
            }
        }else{
            this._remainder = data; // keep it for later
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this._expectedDataLength = 0;
}else{
    this._remainder = data;
}

this._currentMode = this.modes.COMMAND;

return this.<span class="apidocCodeKeywordSpan">_onData</span>(); // rerun with the remainder
        }else{

if(!this._literalStreaming){
    this.lineparser.writeLiteral(data);
}else{
    this._messageStream.emit(&#x22;data&#x22;, new Buffer(data, &#x22;binary&#x22;));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._onEnd" id="apidoc.element.inbox.IMAPClient.prototype._onEnd">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onEnd
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onEnd = function (){
    this.emit(&#x22;end&#x22;);

    if(this.debug){
        console.log(&#x22;EVENT: END&#x22;);
    }

    this._close();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._onError" id="apidoc.element.inbox.IMAPClient.prototype._onError">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onError
        <span class="apidocSignatureSpan">(error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onError = function (error){
    this.emit(&#x22;error&#x22;, error);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._onServerLog" id="apidoc.element.inbox.IMAPClient.prototype._onServerLog">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onServerLog
        <span class="apidocSignatureSpan">(type, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onServerLog = function (type, data){
    this._log.unshift((type?type + &#x22;: &#x22; :&#x22;&#x22;) + (data || &#x22;&#x22;).toString().trim());
    if(this._log.length &#x3e; this._logLength){
        this._log.pop();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
clearTimeout(this._shouldIdleTimer);
clearTimeout(this._idleTimer);
if(this._idleWait || this.idling){
    if(!this._idleWait &#x26;&#x26; this.idling &#x26;&#x26; !this._idleEnd){
        if(this.debug){
            console.log(&#x22;CLIENT: DONE&#x22;);
        }
        this.<span class="apidocCodeKeywordSpan">_onServerLog</span>(&#x22;C&#x22;, &#x22;DONE&#x22;);
        this._connection.write(&#x22;DONE\r\n&#x22;);
        this._idleEnd = true;
    }
    setTimeout(this._processCommandQueue.bind(this), 100);
    return;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._onServerResponse" id="apidoc.element.inbox.IMAPClient.prototype._onServerResponse">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_onServerResponse
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onServerResponse = function (data){
    this._currentHandler(data);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._parseBodystructure" id="apidoc.element.inbox.IMAPClient.prototype._parseBodystructure">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_parseBodystructure
        <span class="apidocSignatureSpan">(bs, parentBodypart)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parseBodystructure = function (bs, parentBodypart) {
    var self = this;

    if (typeof bs === &#x27;string&#x27;) {
        // type information for multipart/alternative or multipart/mixed
        return &#x27;multipart/&#x27; + bs.toLowerCase();
    }

    if (!Array.isArray(bs)) {
        // if it is not the information on which type of multipart/*
        // we&#x27;ve got here, or an array containing valuable information,
        // it is just imap noise
        return;
    }

    if (!Array.isArray(bs[0]) &#x26;&#x26; typeof bs[0] === &#x27;string&#x27; &#x26;&#x26; bs.length &#x3e;= 10) {
        // we&#x27;ve got a single part, usually a text/plain, text/html or attachment part
        var dispositionIndex = 8,
            currentPart = {}, type, subtype;

        currentPart.part = parentBodypart || &#x27;1&#x27;;
        type = bs[0].toLowerCase();
        subtype = bs[1].toLowerCase();
        currentPart.type = type + &#x27;/&#x27; + subtype;
        currentPart.parameters = {};
        if (bs[2]) {
            // the parameters are a key/value list
            var parametersIndex = 0;
            while(parametersIndex &#x3c; bs[2].length) {
                currentPart.parameters[bs[2][parametersIndex].toLowerCase()] = bs[2][parametersIndex + 1].toLowerCase();
                parametersIndex += 2;
            }
        }
        currentPart.encoding = bs[5].toLowerCase();
        currentPart.size = parseInt(bs[6], 10);

        if (type === &#x27;message&#x27; &#x26;&#x26; subtype === &#x27;rfc822&#x27;) {
            // parsing of envelope and body structure information for message/rfc882 mails is not supported,
            // because there are IMAP servers which violate rfc 3501 for message/rfc882, for example gmail.
            return currentPart;
        }

        if (type === &#x27;text&#x27;) {
            // text/* body parts have an additional field for the body size in lines in its content transfer encoding.
            currentPart.lines = parseInt(bs[7], 10);
            dispositionIndex = 9;
        }

        if (bs[dispositionIndex]) {
            currentPart.disposition = [];
            if (Array.isArray(bs[dispositionIndex][0])) {
                bs[dispositionIndex].forEach(function(rawAttachment){
                    if (!rawAttachment) {
                        return;
                    }

                    currentPart.disposition.push(parseAttachment(rawAttachment));
                });
            } else {
                currentPart.disposition.push(parseAttachment(bs[dispositionIndex]));
            }
        }

        return currentPart;
    }

    if (Array.isArray(bs[0])) {
        // we have got a multipart/* message
        var bodypartsCounter = 1, parsedBodystructure = {},
            parsedPart, partIdentifier;

        bs.forEach(function(rawPart) {
            partIdentifier = (parentBodypart ? (parentBodypart + &#x27;.&#x27;) : &#x27;&#x27;) + bodypartsCounter;
            parsedPart = self._parseBodystructure(rawPart, partIdentifier);
            if (typeof parsedPart === &#x27;string&#x27;) {
                parsedBodystructure.type = parsedPart;
            } else if (typeof parsedPart === &#x27;object&#x27;) {
                parsedBodystructure[bodypartsCounter] = parsedPart;
                bodypartsCounter++;
            }
        });

        return parsedBodystructure;
    }

    // helper function to parse attachments
    function parseAttachment(rawAttachment) {
        var parsedAttachment = {};

        parsedAttachment.type = rawAttachment[0].toLowerCase();
        if (rawAttachment[1]) {
            // attachment filename, not present in inline attachments
            parsedAttachment[rawAttachment[1][0].toLowerCase()] = rawAttachment[1][1];
        }

        return parsedAttachment;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var temp = dataObject[&#x22;RFC822.HEADER&#x22;].match(/(X-Originating-IP:).+?]/igm)
    if (temp){
        message.xOriginatingIP = temp[0].substring(&#x27;X-Originating-IP:&#x27;.length).trim().replace(/(\[|\])/g, &#x27;&#x27;);
    }
}

if(dataObject.BODYSTRUCTURE){
    message.bodystructure = this.<span class="apidocCodeKeywordSpan">_parseBodystructure</span>(dataObject.BODYSTRUCTURE);
}

var messageTypes = [],
    messageTypeMap = {
        &#x22;Drafts&#x22;: &#x22;Draft&#x22;,
        &#x22;Flagged&#x22;: &#x22;Starred&#x22;,
        &#x22;Spam&#x22;: &#x22;Junk&#x22;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._postAuth" id="apidoc.element.inbox.IMAPClient.prototype._postAuth">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_postAuth
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_postAuth = function (){
    if(this._capabilities.indexOf(&#x22;CONDSTORE&#x22;)&#x3e;=0){
        this._send(&#x22;ENABLE CONDSTORE&#x22;, this._handlerTaggedCondstore.bind(this));
    }else{
        this._handlerTaggedCondstore(&#x22;OK&#x22;);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if(status == &#x22;OK&#x22;){
    this._xoauth2RetryCount = 0;
    this._xoauth2UntaggedResponse  = false;
    this._currentState = this.states.AUTH;
    if(!this._updatedCapabilities){
        this._send(&#x22;CAPABILITY&#x22;, this._handlerTaggedCapability.bind(this));
    }else{
        this.<span class="apidocCodeKeywordSpan">_postAuth</span>();
    }
}else{
    if(this._xoauth2 &#x26;&#x26; this._xoauth2UntaggedResponse &#x26;&#x26; this._xoauth2RetryCount &#x26;&#x26; this._xoauth2RetryCount
 &#x3c; 3){
        this._xoauth2.generateToken((function(err){
            var error;
            if(err){
                if(typeof err != &#x22;object&#x22;){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._postCapability" id="apidoc.element.inbox.IMAPClient.prototype._postCapability">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_postCapability
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_postCapability = function (){
    if(this._currentState == this.states.PREAUTH){
        this._updatedCapabilities = false;

        if(this._capabilities.indexOf(&#x22;AUTH=XOAUTH2&#x22;)&#x3e;=0 &#x26;&#x26; this._xoauth2){
            this._xoauth2.getToken((function(err, token){
                var error;

                if(err){
                    if(typeof err != &#x22;object&#x22;){
                        error = new Error(err.toString());
                    }else{
                       error = err;
                    }
                    error.errorType = &#x22;AuthenticationError&#x22;;
                    error.errorLog = this._log.slice(0, this._logLength);
                    this.emit(&#x22;error&#x22;, error);
                    return;
                }
                this._send(&#x22;AUTHENTICATE XOAUTH2 &#x22; + token,
                     this._handlerTaggedLogin.bind(this), (function(){
                        this._xoauth2UntaggedResponse = false;
                        this._literalHandler = (function(message){

                            this._xoauth2UntaggedResponse = true;

                            message = (Array.isArray(message) &#x26;&#x26; message[0] || message || &#x22;&#x22;).toString().trim();
                            var data;
                            try{
                                data = JSON.parse(new Buffer(message, &#x22;base64&#x22;).toString(&#x22;utf-8&#x22;));
                            }catch(E){
                                data = {
                                    status: 500,
                                    error: E.message
                                };
                            }

                            if([&#x27;400&#x27;, &#x27;401&#x27;].indexOf((data.status || &#x22;&#x22;).toString().trim())&#x3e;=0){
                                this._xoauth2RetryCount = (this._xoauth2RetryCount || 0) + 1;
                            }

                            this._connection.write(&#x22;\r\n&#x22;);
                            if(this.debug){
                                console.log(&#x22;CLIENT:&#x22;);
                            }
                        }).bind(this);
                     }).bind(this));
            }).bind(this));
        }else if(this._capabilities.indexOf(&#x22;AUTH=XOAUTH&#x22;)&#x3e;=0 &#x26;&#x26; this.options.auth.XOAuthToken){
            if(typeof this.options.auth.XOAuthToken == &#x22;object&#x22;){
                this._send(&#x22;AUTHENTICATE XOAUTH &#x22; + this.options.auth.XOAuthToken.generate(),
                     this._handlerTaggedLogin.bind(this));
            }else{
                this._send(&#x22;AUTHENTICATE XOAUTH &#x22;+(this.options.auth.XOAuthToken || &#x22;&#x22;).toString(),
                     this._handlerTaggedLogin.bind(this));
            }
        }else{
            this._send(&#x22;LOGIN &#x22;+this._escapeString(this.options.auth.user)+&#x22; &#x22;+
                this._escapeString(this.options.auth.pass), this._handlerTaggedLogin.bind(this));
        }
    }else if(this._currentState == this.states.AUTH){
        this._postAuth();
    }else{
        throw new Error(&#x22;Unhandled event state&#x22;);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
IMAPClient.prototype._handlerTaggedCapability = function(status){
if(status == &#x22;OK&#x22;){
    if(!this._secureMode &#x26;&#x26; this._capabilities.indexOf(&#x22;STARTTLS&#x22;)&#x3e;=0){
        this._send(&#x22;STARTTLS&#x22;, this._handlerTaggedStartTLS.bind(this));
        return;
    }

    this.<span class="apidocCodeKeywordSpan">_postCapability</span>();
}else{
    var error = new Error(&#x22;Invalid capability response&#x22;);
    error.errorType = &#x22;ProtocolError&#x22;;
    error.errorLog = this._log.slice(0, this._logLength);
    this.emit(&#x22;error&#x22;, error);
    this._close();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._postReady" id="apidoc.element.inbox.IMAPClient.prototype._postReady">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_postReady
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_postReady = function (err){
    if(err){
        this.emit(&#x22;error&#x22;, err);
    }else{
        this.emit(&#x22;connect&#x22;);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
* Handle ID command. We don&#x27;t reaaly care if the ID succeeded or
* not as it is just some informational data. If it failed we still might be
* able to access the mailbox
*/
IMAPClient.prototype._handlerTaggedId = function(){
   this.<span class="apidocCodeKeywordSpan">_postReady</span>();
};

/**
* Handle CONDSTORE command. We don&#x27;t reaaly care if the CONDSTORE succeeded or
* not as it is just some informational data. If it failed we still might be
* able to access the mailbox
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._processCommandQueue" id="apidoc.element.inbox.IMAPClient.prototype._processCommandQueue">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_processCommandQueue
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_processCommandQueue = function (){

    if(!this._commandQueue.length || !this._connection){
        return;
    }

    // If the client is currently on idle, stop it
    clearTimeout(this._shouldIdleTimer);
    clearTimeout(this._idleTimer);
    if(this._idleWait || this.idling){
        if(!this._idleWait &#x26;&#x26; this.idling &#x26;&#x26; !this._idleEnd){
            if(this.debug){
                console.log(&#x22;CLIENT: DONE&#x22;);
            }
            this._onServerLog(&#x22;C&#x22;, &#x22;DONE&#x22;);
            this._connection.write(&#x22;DONE\r\n&#x22;);
            this._idleEnd = true;
        }
        setTimeout(this._processCommandQueue.bind(this), 100);
        return;
    }

    var command = this._commandQueue.shift();

    if(typeof command.prewrite == &#x22;function&#x22;){
        command.prewrite();
    }

    this._onServerLog(&#x22;C&#x22;, command.data);
    this._connection.write(command.data);

    if(this.debug){
        console.log(&#x22;CLIENT: &#x22;+ (command.data || &#x22;&#x22;).trim());
    }

    this._currentRequest = {
        tag: command.tag,
        callback: (function(status, params){

            clearTimeout(this._shouldIdleTimer);
            clearTimeout(this._idleTimer);
            if(!this.idling &#x26;&#x26; !this._idleWait &#x26;&#x26; this._currentState == this.states.SELECTED){
                this._shouldIdleTimer = setTimeout(this.idle.bind(this), this.ENTER_IDLE);
            }

            if(typeof command.callback == &#x22;function&#x22;){
                command.callback(status, params);
            }
            this._currentRequest = false;

            this._processCommandQueue();
        }).bind(this)
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
IMAPClient.prototype._send = function(data, callback, prewrite){
    data = (data || &#x22;&#x22;).toString();
    var tag = &#x22;A&#x22; + (++this._tagCounter);

    this._commandQueue.push({tag: tag, data: tag + &#x22; &#x22; + data + &#x22;\r\n&#x22;, callback: callback, prewrite: prewrite
});

    if(this.idling || !this._currentRequest){
        this.<span class="apidocCodeKeywordSpan">_processCommandQueue</span>();
    }
};

/**
 * Send a command form the command queue to the server
 */
IMAPClient.prototype._processCommandQueue = function(){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._responseRouter" id="apidoc.element.inbox.IMAPClient.prototype._responseRouter">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_responseRouter
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_responseRouter = function (data){
    if(!data || !Array.isArray(data)){
        return;
    }

    // Handle tagged commands
    if(this._currentRequest &#x26;&#x26; this._currentRequest.tag == data[0]){
        this._currentRequest.callback(data[1], data.slice(2));
        return;
    }

    // handle commands tagged with +
    if(data[0]==&#x22;+&#x22;){
        if(this._idleWait){
            this._handlerUntaggedIdle();
        }

        if(this._literalHandler){
            this._literalHandler(data.slice(1));
        }
    }else if(this._literalHandler){
        this._literalHandler = null;
    }

    // handle untagged commands (tagged with *)
    if(data[0]==&#x22;*&#x22;){
        switch(data[1]){
            case &#x22;CAPABILITY&#x22;:
                this._handlerUntaggedCapability(data.slice(2));
                return;
            case &#x22;ID&#x22;:
                this._handlerUntaggedId(data.slice(2));
                return;
            case &#x22;ENABLED&#x22;:
                this._handlerUntaggedEnabled(data.slice(2));
                return;
            case &#x22;FLAGS&#x22;:
                this._selectedMailbox.flags = data[2] || [];
                return;
            case &#x22;SEARCH&#x22;:
                this._handlerUntaggedSearch(data.slice(2));
                return;
            case &#x22;XLIST&#x22;:
            case &#x22;LIST&#x22;:
                this._handlerUntaggedList(data.slice(2));
                return;
            case &#x22;LSUB&#x22;:
                this._handlerUntaggedLsub(data.slice(2));
                return;
            case &#x22;OK&#x22;:
                if(typeof data[2] == &#x22;object&#x22;){
                    if(Array.isArray(data[2].params)){
                        if(data[2].params[0] == &#x22;UIDVALIDITY&#x22;){
                            this._selectedMailbox.UIDValidity = data[2].params[1];
                            return;
                        }else if(data[2].params[0] == &#x22;UIDNEXT&#x22;){
                            this._selectedMailbox.UIDNext = data[2].params[1];
                            return;
                        }else if(data[2].params[0] == &#x22;HIGHESTMODSEQ&#x22;){
                            this._selectedMailbox.highestModSeq = Number(data[2].params[1]);
                            return;
                        }else if(data[2].params[0] == &#x22;UNSEEN&#x22;){
                            this._selectedMailbox.unseen = data[2].params[1];
                            return;
                        }else if(data[2].params[0] == &#x22;PERMANENTFLAGS&#x22;){
                            this._selectedMailbox.permanentFlags = data[2].params[1] || [];
                            return;
                        }
                    }
                }
                return;
        }

        if(!isNaN(data[1]) &#x26;&#x26; data[2] == &#x22;FETCH&#x22;){
            this._handlerUntaggedFetch(data);
            return;
        }

        if(!isNaN(data[1]) &#x26;&#x26; data[2] == &#x22;EXPUNGE&#x22;){
            if(this._selectedMailbox.count){
                this._selectedMailbox.count--;
            }
        }

        if(!isNaN(data[1]) &#x26;&#x26; data[2] == &#x22;EXISTS&#x22;){
            if(this._selectedMailbox.count != Number(data[1])){
                this._selectedMailbox.count = Number(data[1]) || this._selectedMailbox.count || 0;
                if(this.idling || this.nooping){
                    this._checkNewMail();
                }
            }
            return;
        }

    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype._send" id="apidoc.element.inbox.IMAPClient.prototype._send">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>_send
        <span class="apidocSignatureSpan">(data, callback, prewrite)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_send = function (data, callback, prewrite){
    data = (data || &#x22;&#x22;).toString();
    var tag = &#x22;A&#x22; + (++this._tagCounter);

    this._commandQueue.push({tag: tag, data: tag + &#x22; &#x22; + data + &#x22;\r\n&#x22;, callback: callback, prewrite: prewrite});

    if(this.idling || !this._currentRequest){
        this._processCommandQueue();
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        this._close();
        return;
    }

    this._currentState = this.states.PREAUTH;
    this._currentHandler = this._responseRouter;

    this.<span class="apidocCodeKeywordSpan">_send</span>(&#x22;CAPABILITY&#x22;, this._handlerTaggedCapability.bind(this));
};

/**
 * When the greeting is not received in GREETING_TIMEOUT time,
 * emit an error and close the socket
 */
IMAPClient.prototype._handleGreetingTimeout = function(){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.addFlags" id="apidoc.element.inbox.IMAPClient.prototype.addFlags">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>addFlags
        <span class="apidocSignatureSpan">(uid, flags, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFlags = function (uid, flags, callback){
    flags = [].concat(flags || []);
    this.updateFlags(uid, flags, &#x22;+&#x22;, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
query = {unseen: true, not: {seen: true}}
```

Returned list is already sorted and all values are numbers.

### Message flags

You can add and remove message flags like `\Seen` or `\Answered` with `client.<span class="apidocCodeKeywordSpan">addFlags</span
>()` and `client.removeFlags()`

**List flags**
```javascript
client.fetchFlags(uid, callback)
```

Where
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.addLabels" id="apidoc.element.inbox.IMAPClient.prototype.addLabels">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>addLabels
        <span class="apidocSignatureSpan">(uid, labels, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addLabels = function (uid, labels, callback){
    labels = [].concat(labels || []);
    this.updateLabels(uid, labels, &#x22;+&#x22;, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.close" id="apidoc.element.inbox.IMAPClient.prototype.close">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function (){
    this._send(&#x22;LOGOUT&#x22;, (function (){
        this._close();
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

### Logout and disconnect

Logout from IMAP and close NET connection.

```javascript
client.<span class="apidocCodeKeywordSpan">close</span>();
client.on(&#x27;close&#x27;, function (){
    console.log(&#x27;DISCONNECTED!&#x27;);
});
```

### List available mailboxes
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.connect" id="apidoc.element.inbox.IMAPClient.prototype.connect">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>connect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connect = function (){

    if(this.options.secureConnection){
        this._connection = tls.connect(this.port, this.host, {rejectUnauthorized: false}, this._onConnect.bind(this));
    }else{
        this._connection = net.connect(this.port, this.host);
        this._connection.on(&#x22;connect&#x22;, this._onConnect.bind(this));
    }

    this._connection.on(&#x22;error&#x22;, this._onError.bind(this));

    this._greetingTimeout = setTimeout(this._handleGreetingTimeout.bind(this), this.GREETING_TIMEOUT);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        })
    }
});
```

Once the connection object has been created, use connect() to create the actual connection.
```javascript
client.<span class="apidocCodeKeywordSpan">connect</span>();
```

When the connection has been successfully established a &#x27;connect&#x27; event is emitted.
```javascript
client.on(&#x22;connect&#x22;, function(){
    console.log(&#x22;Successfully connected to server&#x22;);
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.copyMessage" id="apidoc.element.inbox.IMAPClient.prototype.copyMessage">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>copyMessage
        <span class="apidocSignatureSpan">(uid, destination, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">copyMessage = function (uid, destination, callback){
    uid = Number(uid) || 0;

    if(!uid){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;Invalid UID value&#x22;));
        }
        return;
    }

    if(this._currentState != this.states.SELECTED){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;No mailbox selected&#x22;));
        }
        return;
    }

    this._send(&#x22;UID COPY &#x22; + uid + &#x22; &#x22; + this._escapeString(destination), (function(status){
        if(status != &#x22;OK&#x22;){
            return callback(new Error(&#x22;Error copying message&#x22;));
        }
        return callback(null, true);
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

When adding a message to the mailbox, the new message event is also raised after
the mail has been stored.

### Copy a message

You can copy a message from the current mailbox to a selected one with `client.<span class="apidocCodeKeywordSpan">copyMessage</
span>()`
```javascript
client.copyMessage(uid, destination, callback)
```

Where

* **uid** is the message identifier.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.createMailbox" id="apidoc.element.inbox.IMAPClient.prototype.createMailbox">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>createMailbox
        <span class="apidocSignatureSpan">(path, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createMailbox = function (path, callback){
    this._rootMailbox.createChild(path, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.client.openMailbox(&#x22;INBOX&#x22;, (function(err){
        this.client.storeMessage(&#x22;Subject: hello 8\r\n\r\nWorld 8!&#x22;, function(){});
    }).bind(this));
},

&#x22;Create mailbox&#x22;: function(test){
    var self = this;
    this.client.<span class="apidocCodeKeywordSpan">createMailbox</span>(&#x22;NEW-MAILBOX&#x22;, function(err, mailbox){
        test.ifError(err);
        test.equal(mailbox.path, &#x22;NEW-MAILBOX&#x22;);
        test.equal(mailbox.type, &#x22;Normal&#x22;);
        test.equal(mailbox.delimiter, &#x22;/&#x22;);
        self.client.openMailbox(&#x22;NEW-MAILBOX&#x22;, function(err, mailbox){
            test.ifError(err);
            test.equal(mailbox.count, 0);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.createMessageStream" id="apidoc.element.inbox.IMAPClient.prototype.createMessageStream">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>createMessageStream
        <span class="apidocSignatureSpan">(uid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createMessageStream = function (uid){
    var stream = new Stream();

    uid = Number(uid) || 0;

    if(!uid){
        process.nextTick(this.emit.bind(this, new Error(&#x22;Invalid UID value&#x22;)));
        return;
    }

    if(this._currentState != this.states.SELECTED){
        process.nextTick(this.emit.bind(this, new Error(&#x22;No inbox selected&#x22;)));
        return;
    }

    this._send(&#x22;UID FETCH &#x22; + uid + &#x22; BODY.PEEK[]&#x22;, (function(status){
        this._collectMailList = false;
        this._literalStreaming = false;

        if(!this._mailList.length){
            if(status == &#x22;OK&#x22;){
                stream.emit(&#x22;error&#x22;, new Error(&#x22;Selected message not found: &#x22;+uid+&#x22;; &#x22;+this.port+&#x22;; &#x22;+this.host+&#x22;; &#x22;+JSON.stringify
(this._selectedMailbox)));
            }else{
                stream.emit(&#x22;error&#x22;, new Error(&#x22;Error fetching message: &#x22;+uid+&#x22;; &#x22;+this.port+&#x22;; &#x22;+this.host+&#x22;; &#x22;+JSON.stringify(
this._selectedMailbox)));
            }
        }

        this._messageStream.emit(&#x22;end&#x22;);
        this._messageStream.removeAllListeners();

        this._messageStream = null;

    }).bind(this),
    (function(){
        this._collectMailList = true;
        this._literalStreaming = true;
        this._mailList = [];
        this._messageStream = stream;
    }).bind(this));

    return stream;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

### Fetch message contents

Message listing only retrieves the envelope part of the message. To get the full RFC822 message body
you need to fetch the message.
```javascript
var messageStream = client.<span class="apidocCodeKeywordSpan">createMessageStream</span>(uid)
```

Where

  * **uid** is the UID value for the mail

Example (output message contents to console)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.deleteMailbox" id="apidoc.element.inbox.IMAPClient.prototype.deleteMailbox">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>deleteMailbox
        <span class="apidocSignatureSpan">(path, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">deleteMailbox = function (path, callback){
    this._rootMailbox.deleteChild(path, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        });
    });
},

&#x22;Delete mailbox&#x22;: function(test){
    var self = this;
    this.client.createMailbox(&#x22;NEW-MAILBOX&#x22;, function(err, mailbox){
        self.client.<span class="apidocCodeKeywordSpan">deleteMailbox</span>(&#x22;NEW-MAILBOX&#x22;, function(err, status){
            test.ifError(err);
            test.equal(status, &#x22;OK&#x22;);
            self.client.openMailbox(&#x22;NEW-MAILBOX&#x22;, function(err, mailbox){
                test.ok(err);
                test.ok(!mailbox);
                test.done();
            });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.deleteMessage" id="apidoc.element.inbox.IMAPClient.prototype.deleteMessage">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>deleteMessage
        <span class="apidocSignatureSpan">(uid, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">deleteMessage = function (uid, callback){
    uid = Number(uid) || 0;

    if(!uid){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;Invalid UID value&#x22;));
        }
        return;
    }

    this.addFlags(uid, &#x22;\\Deleted&#x22;, (function(error){
        if(error){
            return callback(error);
        }

        this._send(&#x22;EXPUNGE&#x22;, (function(status){
            if(status != &#x22;OK&#x22;){
                return callback(new Error(&#x22;Error removing message&#x22;));
            }
            return callback(null, true);
        }).bind(this));

    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
client.moveMessage(123, &#x22;[GMail]/Junk&#x22;, function(err){
  console.log(err || &#x22;success, moved to junk&#x22;);
});
```

### Delete a message

You can delete a message from current mailbox with `client.<span class="apidocCodeKeywordSpan">deleteMessage</span>()`
```javascript
client.deleteMessage(uid, callback)
```

Where

* **uid** is the message identifier.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.fetchData" id="apidoc.element.inbox.IMAPClient.prototype.fetchData">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>fetchData
        <span class="apidocSignatureSpan">(uid, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fetchData = function (uid, callback){
    uid = Number(uid) || 0;

    if(!uid){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;Invalid UID value&#x22;));
        }
        return;
    }

    if(this._currentState != this.states.SELECTED){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;No mailbox selected&#x22;));
        }
        return;
    }

    this._send(&#x22;UID FETCH &#x22; + uid + &#x22; (UID FLAGS ENVELOPE RFC822.HEADER&#x22; +
      (this._capabilities.indexOf(&#x22;X-GM-EXT-1&#x22;)&#x3e;=0?&#x22; X-GM-LABELS X-GM-THRID&#x22;:&#x22;&#x22;) +
      (this._capabilities.indexOf(&#x22;CONDSTORE&#x22;) &#x3e;= 0 ? &#x22; MODSEQ&#x22; : &#x22;&#x22;) +
      &#x22;)&#x22;, (function(status){
        this._collectMailList = false;

        if(typeof callback != &#x22;function&#x22;){
            return;
        }

        if(typeof callback == &#x22;function&#x22;){
            if(status == &#x22;OK&#x22;){
                if(!this._mailList.length){
                    callback(null, null);
                }else{
                    callback(null, this._mailList[0]);
                }
            }else{
                callback(new Error(&#x22;Error fetching message data&#x22;));
            }
        }

    }).bind(this),
    (function(){
        this._collectMailList = true;
        this._mailList = [];
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
]
```

### Fetch message details

To fetch message data (flags, title, etc) for a specific message, use
```javascript
client.<span class="apidocCodeKeywordSpan">fetchData</span>(uid, callback)
```

Where

* **uid** is the UID value for the mail
* **callback** *(error, message)* is the callback function to with the message data object (or null if the message was not found
). Gets an error parameter if error occured
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.fetchFlags" id="apidoc.element.inbox.IMAPClient.prototype.fetchFlags">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>fetchFlags
        <span class="apidocSignatureSpan">(uid, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fetchFlags = function (uid, callback){
    uid = Number(uid) || 0;

    if(!uid){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;Invalid UID value&#x22;));
        }
        return;
    }

    if(this._currentState != this.states.SELECTED){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;No mailbox selected&#x22;));
        }
        return;
    }

    this._send(&#x22;UID FETCH &#x22; + uid + &#x22; (UID FLAGS)&#x22;, (function(status){
        this._collectMailList = false;

        if(typeof callback != &#x22;function&#x22;){
            return;
        }

        if(typeof callback == &#x22;function&#x22;){
            if(status == &#x22;OK&#x22;){
                if(!this._mailList.length){
                    callback(null, null);
                }else{
                    callback(null, this._mailList[0].flags || []);
                }
            }else{
                callback(new Error(&#x22;Error fetching message flags&#x22;));
            }
        }

    }).bind(this),
    (function(){
        this._collectMailList = true;
        this._mailList = [];
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

### Message flags

You can add and remove message flags like `\Seen` or `\Answered` with `client.addFlags()` and `client.removeFlags()`

**List flags**
```javascript
client.<span class="apidocCodeKeywordSpan">fetchFlags</span>(uid, callback)
```

Where

* **uid** is the message identifier
* **callback** *(error, flags)* is the callback to run, gets message flags array as a parameter
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.getCurrentMailbox" id="apidoc.element.inbox.IMAPClient.prototype.getCurrentMailbox">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>getCurrentMailbox
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getCurrentMailbox = function (){
    return this._selectedMailbox;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.getMailbox" id="apidoc.element.inbox.IMAPClient.prototype.getMailbox">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>getMailbox
        <span class="apidocSignatureSpan">(path, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getMailbox = function (path, callback){
    this._rootMailbox.listChildren(path, function(error, mailboxes){
        if(error){
            callback(error);
        }else if(mailboxes &#x26;&#x26; mailboxes.length){
            callback(null, mailboxes[0]);
        }else{
            callback(null, null);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

### Fetch a specified mailbox object

If you need to access a specific mailbox object (for creating or listing child
mailboxes etc.), you can do it with
```javascript
client.<span class="apidocCodeKeywordSpan">getMailbox</span>(path, callback)
```

Where

* **path** is the mailbox directory path
* **callback** *(error, mailbox)* is the callback function
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.idle" id="apidoc.element.inbox.IMAPClient.prototype.idle">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>idle
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">idle = function (){
    if(this._capabilities.indexOf(&#x22;IDLE&#x22;)&#x3e;=0){
        this._send(&#x22;IDLE&#x22;, (function(){
            this.idling = false;
            this._idleEnd = false;
        }).bind(this), (function(){
            this._idleWait = true;
            this._idleEnd = false;
            this._idleTimer = setTimeout(this._idleTimeout.bind(this), this.IDLE_TIMEOUT);
        }).bind(this));
    }else{
        if(this.debug){
            console.log(&#x22;WARNING: Server does not support IDLE, fallback to NOOP&#x22;);
        }
        this._idleTimer = setTimeout((function(){
            this._send(&#x22;NOOP&#x22;, (function(){
                this.nooping = false;
            }).bind(this), (function(){
                this.nooping = true;
            }).bind(this));
        }).bind(this), this.IDLE_TIMEOUT);
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.listFlags" id="apidoc.element.inbox.IMAPClient.prototype.listFlags">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>listFlags
        <span class="apidocSignatureSpan">(from, limit, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listFlags = function (from, limit, callback){
    var to;

    from = Number(from) || 0;

    if(typeof limit == &#x22;function&#x22; &#x26;&#x26; !callback){
        callback = limit;
        limit = undefined;
    }

    limit = Number(limit) || 0;

    if(this._currentState != this.states.SELECTED){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;No mailbox selected&#x22;));
        }
        return;
    }

    if(from &#x3c; 0){
        from = this._selectedMailbox.count + from;
    }

    if(from &#x3c; 0){
        from = 0;
    }

    if(limit){
        to = from + limit;
    }else{
        to = &#x22;*&#x22;;
    }

    from++;

    this._collectMailList = true;
    this._mailList = [];
    this._send(&#x22;FETCH &#x22; + from + &#x22;:&#x22; + to + &#x22; (UID FLAGS)&#x22;, (function(status){
        this._collectMailList = false;

        if(typeof callback != &#x22;function&#x22;){
            return;
        }

        if(status == &#x22;OK&#x22;){
            callback(null, this._mailList);
        }else{
            callback(new Error(&#x22;Error fetching list&#x22;));
        }
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* **lastUID** is the UID value to end listing with, can be a number or &#x22;*&#x22;
* **callback** is the same as with `listMessage`

### Listing flags

As a shorthand listing, you can also list only UID and Flags pairs
```javascript
client.<span class="apidocCodeKeywordSpan">listFlags</span>(from[, limit], callback)
```

Where

* **from** is the index of the first message (0 based), you can use negative numbers to count from the end (-10 indicates the 10
 last messages)
* **limit** defines the maximum count of messages to fetch, if not set or 0 all messages from the starting position will be included
* **callback** *(error, messages)* is the callback function to run with the message array
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.listMailboxes" id="apidoc.element.inbox.IMAPClient.prototype.listMailboxes">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>listMailboxes
        <span class="apidocSignatureSpan">(path, all, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listMailboxes = function (path, all, callback){
    this._rootMailbox.listChildren(path, all, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
```

### List available mailboxes

To list the available mailboxes use
```javascript
client.<span class="apidocCodeKeywordSpan">listMailboxes</span>(callback)
```

Where

  * **callback** *(error, mailboxes)* returns a list of root mailbox object

Mailbox objects have the following properties
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.listMessages" id="apidoc.element.inbox.IMAPClient.prototype.listMessages">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>listMessages
        <span class="apidocSignatureSpan">(from, limit, extendedOptions, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listMessages = function (from, limit, extendedOptions, callback){
    var to;

    from = Number(from) || 0;

    if(typeof extendedOptions == &#x22;function&#x22; &#x26;&#x26; !callback){
        callback = extendedOptions;
        extendedOptions = undefined;
    }

    if(typeof limit == &#x22;function&#x22; &#x26;&#x26; !callback){
        callback = limit;
        limit = undefined;
    }

    extendedOptions = extendedOptions || &#x22;&#x22;;
    limit = Number(limit) || 0;

    if(this._currentState != this.states.SELECTED){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;No mailbox selected&#x22;));
        }
        return;
    }

    // Nothing to retrieve
    if(!this._selectedMailbox.count){
        return callback(null, []);
    }

    if(from &#x3c; 0){
        from = this._selectedMailbox.count + from;
    }

    if(from &#x3c; 0){
        from = 0;
    }

    if(limit){
        to = from + limit;
    }else{
        to = &#x22;*&#x22;;
    }

    from++;

    this._collectMailList = true;
    this._mailList = [];

    this._send(
      &#x22;FETCH &#x22; + from + &#x22;:&#x22; + to +
      &#x22; (UID BODYSTRUCTURE FLAGS ENVELOPE INTERNALDATE RFC822.HEADER&#x22; +
      (this._capabilities.indexOf(&#x22;X-GM-EXT-1&#x22;)&#x3e;=0?&#x22; X-GM-LABELS X-GM-THRID&#x22;:&#x22;&#x22;) +
      (this._capabilities.indexOf(&#x22;CONDSTORE&#x22;) &#x3e;= 0 ? &#x22; MODSEQ&#x22; : &#x22;&#x22;) +
      &#x22;)&#x22; +
      (extendedOptions ? &#x22; &#x22;+extendedOptions : &#x22;&#x22;), (function(status){
        this._collectMailList = false;

        if(typeof callback != &#x22;function&#x22;){
            return;
        }

        if(status == &#x22;OK&#x22;){
            callback(null, this._mailList);
        }else{
            callback(new Error(&#x22;Error fetching list&#x22;));
        }
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
```

### Listing e-mails

Once a mailbox has been opened you can list contained e-mails with
```javascript
client.<span class="apidocCodeKeywordSpan">listMessages</span>(from[, limit], callback)
```

Where

* **from** is the index of the first message (0 based), you can use negative numbers to count from the end (-10 indicates the 10
 last messages)
* **limit** defines the maximum count of messages to fetch, if not set or 0 all messages from the starting position will be included
* **callback** *(error, messages)* is the callback function to run with the message array
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.listMessagesByUID" id="apidoc.element.inbox.IMAPClient.prototype.listMessagesByUID">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>listMessagesByUID
        <span class="apidocSignatureSpan">(from, to, extendedOptions, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listMessagesByUID = function (from, to, extendedOptions, callback){
    from = Number(from) || 0;

    if(typeof extendedOptions == &#x22;function&#x22; &#x26;&#x26; !callback){
        callback = extendedOptions;
        extendedOptions = undefined;
    }

    if(typeof to == &#x22;function&#x22; &#x26;&#x26; !callback){
        callback = to;
        to = undefined;
    }

    extendedOptions = extendedOptions || &#x22;&#x22;;
    to = Number(to) || &#x22;*&#x22;;

    if(this._currentState != this.states.SELECTED){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;No mailbox selected&#x22;));
        }
        return;
    }

    // Nothing to retrieve
    if(!this._selectedMailbox.count){
        return callback(null, []);
    }

    this._collectMailList = true;
    this._mailList = [];

    this._send(
      &#x22;UID FETCH &#x22; + from + &#x22;:&#x22; + to +
      &#x22; (UID BODYSTRUCTURE FLAGS ENVELOPE INTERNALDATE RFC822.HEADER&#x22; +
      (this._capabilities.indexOf(&#x22;X-GM-EXT-1&#x22;)&#x3e;=0?&#x22; X-GM-LABELS X-GM-THRID&#x22;:&#x22;&#x22;) +
      (this._capabilities.indexOf(&#x22;CONDSTORE&#x22;) &#x3e;= 0 ? &#x22; MODSEQ&#x22; : &#x22;&#x22;) +
      &#x22;)&#x22; +
      (extendedOptions ? &#x22; &#x22;+extendedOptions : &#x22;&#x22;), (function(status){
        this._collectMailList = false;

        if(typeof callback != &#x22;function&#x22;){
            return;
        }

        if(status == &#x22;OK&#x22;){
            callback(null, this._mailList);
        }else{
            callback(new Error(&#x22;Error fetching list&#x22;));
        }
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
there is no &#x22;cc&#x22; field in the message object.

### Listing messages by UID

You can list messages by UID with

```javascript
client.<span class="apidocCodeKeywordSpan">listMessagesByUID</span>(firstUID, lastUID, callback)
```

Where

* **firstUI** is the UID value to start listing from
* **lastUID** is the UID value to end listing with, can be a number or &#x22;*&#x22;
* **callback** is the same as with `listMessage`
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.moveMessage" id="apidoc.element.inbox.IMAPClient.prototype.moveMessage">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>moveMessage
        <span class="apidocSignatureSpan">(uid, destination, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">moveMessage = function (uid, destination, callback){
    this.copyMessage(uid, destination, (function(error){
        if(error){
            return callback(error);
        }
        this.deleteMessage(uid, function(error){
            // we don&#x27;t really care if the removal succeeded or not at this point
            return callback(null, !error);
        });
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
client.copyMessage(123, &#x22;[GMail]/Junk&#x22;, function(err){
  console.log(err || &#x22;success, copied to junk&#x22;);
});
```

### Move a message

You can move a message from current mailbox to a selected one with `client.<span class="apidocCodeKeywordSpan">moveMessage</span
>()`
```javascript
client.moveMessage(uid, destination, callback)
```

Where

* **uid** is the message identifier.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.openMailbox" id="apidoc.element.inbox.IMAPClient.prototype.openMailbox">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>openMailbox
        <span class="apidocSignatureSpan">(path, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">openMailbox = function (path, options, callback){
    var command = &#x22;SELECT&#x22;;

    if(typeof options == &#x22;function&#x22; &#x26;&#x26; !callback){
        callback = options;
        options = undefined;
    }

    options = options || {};

    if(options.readOnly){
        command = &#x22;EXAMINE&#x22;;
    }

    if(typeof path == &#x22;object&#x22;){
        path = path.path;
    }

    if(!path){
        return callback(new Error(&#x22;Invalid or missing mailbox path provided&#x22;));
    }

    this._selectedMailbox = {
        path: path
    };

    this._send(command + &#x22; &#x22; + this._escapeString(path)+(
        this._condstoreEnabled?&#x22; (CONDSTORE)&#x22;:&#x22;&#x22;
      ), this._handlerTaggedSelect.bind(this, callback));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
```

### Select a mailbox

Before you can check mailbox contents, you need to select one with
```javascript
client.<span class="apidocCodeKeywordSpan">openMailbox</span>(path[, options], callback)
```

Where

* **path** is the path to the mailbox (ie. &#x22;INBOX&#x22; or &#x22;INBOX/Arhiiv&#x22;) or a mailbox object
* **options** is an optional options object
* **options.readOnly** - if set to true, open the mailbox in read-only mode (downloading messages does not update seen/unseen flag
)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.removeFlags" id="apidoc.element.inbox.IMAPClient.prototype.removeFlags">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>removeFlags
        <span class="apidocSignatureSpan">(uid, flags, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeFlags = function (uid, flags, callback){
    flags = [].concat(flags || []);
    this.updateFlags(uid, flags, &#x22;-&#x22;, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
query = {unseen: true, not: {seen: true}}
```

Returned list is already sorted and all values are numbers.

### Message flags

You can add and remove message flags like `\Seen` or `\Answered` with `client.addFlags()` and `client.<span class="apidocCodeKeywordSpan
">removeFlags</span>()`

**List flags**
```javascript
client.fetchFlags(uid, callback)
```

Where
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.removeLabels" id="apidoc.element.inbox.IMAPClient.prototype.removeLabels">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>removeLabels
        <span class="apidocSignatureSpan">(uid, labels, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeLabels = function (uid, labels, callback){
    labels = [].concat(labels || []);
    this.updateLabels(uid, labels, &#x22;-&#x22;, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.search" id="apidoc.element.inbox.IMAPClient.prototype.search">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>search
        <span class="apidocSignatureSpan">(query, isUid, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">search = function (query, isUid, callback){
    if(!callback &#x26;&#x26; typeof isUid == &#x22;function&#x22;){
        callback = isUid;
        isUid = undefined;
    }

    var queryType = isUid ? &#x22;UID SEARCH&#x22; : &#x22;SEARCH&#x22;,
        self = this,

        buildTerm = function(query){
            return Object.keys(query).map(function(key){
                var term = key.toUpperCase(),
                    params = [],
                    escapeDate = function(date){
                        return self._escapeString(date.toUTCString().replace(/^\w+, (\d+) (\w+) (\d+).*/, &#x22;$1-$2-$3&#x22;));
                    },
                    escapeParam = function(param){
                        var list = [];
                        if(typeof param == &#x22;number&#x22;){
                            list.push(String(param));
                        }else if(typeof param == &#x22;string&#x22;){
                            list.push(self._escapeString(param));
                        }else if(Object.prototype.toString.call(param) == &#x22;[object Date]&#x22;){
                            list.push(escapeDate(param));
                        }else if(Array.isArray(param)){
                            param.map(escapeParam).forEach(function(p){
                                if(typeof p == &#x22;string&#x22;){
                                    list.push(p);
                                }
                            });
                        }else if(typeof param == &#x22;object&#x22;){
                            return buildTerm(param);
                        }
                        return list.join(&#x22; &#x22;);
                    };

                [].concat(query[key] || []).forEach(function(param){
                    param = escapeParam(param);
                    if(param){
                        params.push(param);
                    }
                });

                return term + (params.length ? &#x22; &#x22; + params.join(&#x22; &#x22;) : &#x22;&#x22;);
            }).join(&#x22; &#x22;);
        },

        queryTerm = buildTerm(query);

    this._collectMailList = true;
    this._mailList = [];

    this._send(queryType + (queryTerm ? &#x22; &#x22; + queryTerm : &#x22;&#x22;), (function(status){
        this._collectMailList = false;

        if(typeof callback != &#x22;function&#x22;){
            return;
        }

        if(status == &#x22;OK&#x22;){
            callback(null, this._mailList.sort(function(a, b){return a-b;}));
        }else{
            callback(new Error(&#x22;Error searching messages&#x22;));
        }
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
automatically marked as read (\Seen flag is set) when the message is fetched.

### Searching for messages

You can search for messages with

```javascript
client.<span class="apidocCodeKeywordSpan">search</span>(query[, isUID], callback)
```

Where

* **query** is the search term as an object
* **isUID** is an optional boolean value - if set to true perform `UID SEARCH` instead of `SEARCH`
* **callback** is the callback function with error object and an array of matching seq or UID numbers
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.storeMessage" id="apidoc.element.inbox.IMAPClient.prototype.storeMessage">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>storeMessage
        <span class="apidocSignatureSpan">(message, flags, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">storeMessage = function (message, flags, callback){
    if(typeof flags == &#x22;function&#x22; &#x26;&#x26; !callback){
        callback = flags;
        flags = undefined;
    }

    message = message || &#x22;&#x22;;
    if(typeof message == &#x22;string&#x22;){
        message = new Buffer(message, &#x22;utf-8&#x22;);
    }

    flags = [].concat(flags || []);
    this._send(&#x22;APPEND &#x22; + this._escapeString(this._selectedMailbox.path) + (flags.length ? &#x22; (&#x22; + flags.join(&#x22; &#x22;)+&#x22;)&#x22;:&#x22;&#x22;) + &#x22; {&#x22; +
message.length+&#x22;}&#x22;, (function(status, data){
        this._literalHandler = null;
        if(status == &#x22;OK&#x22;){
            this._shouldCheckOnIdle = true;

            // supports APPENDUID
            if(data &#x26;&#x26; data[0] &#x26;&#x26; data[0].params &#x26;&#x26; data[0].params[0] == &#x22;APPENDUID&#x22;){
                return callback(null, {
                    UIDValidity: data[0].params[1] || &#x22;&#x22;,
                    UID: data[0].params[2] || &#x22;&#x22;
                });
            }

            // Guess the values from mailbox data. Not sure if it really works :S
            return callback(null, {
                UIDValidity: this._selectedMailbox.UIDValidity,
                UID: this._selectedMailbox.UIDNext
            });
        }else{
            return callback(new Error(&#x22;Error saving message to mailbox&#x22;));
        }
    }).bind(this), (function(){
        this._literalHandler = (function(){
            this._connection.write(message);
            this._connection.write(&#x22;\r\n&#x22;);
        }).bind(this);
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
client.removeFlags(123, [&#x22;\\Flagged&#x22;], function(err, flags){
  console.log(&#x22;Current flags for a message: &#x22;, flags);
});
```

### Upload a message

You can upload a message to current mailbox with `client.<span class="apidocCodeKeywordSpan">storeMessage</span>()`
```javascript
client.storeMessage(message[, flags], callback)
```

Where

* **message** is the message to be uploaded either as a string or a Buffer.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.updateFlags" id="apidoc.element.inbox.IMAPClient.prototype.updateFlags">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>updateFlags
        <span class="apidocSignatureSpan">(uid, flags, updateType, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateFlags = function (uid, flags, updateType, callback){
    flags = [].concat(flags || []);

    if(!callback &#x26;&#x26; typeof updateType == &#x22;function&#x22;){
        callback = updateType;
        updateType = undefined;
    }

    updateType = (updateType || &#x22;&#x22;).toString().trim();

    if(!uid){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;Invalid UID value&#x22;));
        }
        return;
    }

    if(!Array.isArray(flags)){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;Invalid flags value&#x22;));
        }
        return;
    }

    if(this._currentState != this.states.SELECTED){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;No mailbox selected&#x22;));
        }
        return;
    }

    this._send(&#x22;UID STORE &#x22;+uid+&#x22; &#x22;+updateType+&#x22;FLAGS (&#x22; + flags.join(&#x22; &#x22;) + &#x22;)&#x22;,
      (function(status){
        this._collectMailList = false;

        if(typeof callback != &#x22;function&#x22;){
            return;
        }

        if(typeof callback == &#x22;function&#x22;){
            if(status == &#x22;OK&#x22;){
                if(!this._mailList.length){
                    callback(null, true);
                }else{
                    callback(null, this._mailList[0].flags || []);
                }
            }else{
                callback(new Error(&#x22;Error setting flags&#x22;));
            }
        }

    }).bind(this),
    (function(){
        this._collectMailList = true;
        this._mailList = [];
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @param {String} uid Message identifier
* @param {Array} flags Flags to set for a message
* @param {Function} callback Callback function to run, returns an array of flags
*/
IMAPClient.prototype.addFlags = function(uid, flags, callback){
   flags = [].concat(flags || []);
   this.<span class="apidocCodeKeywordSpan">updateFlags</span>(uid, flags, &#x22;+&#x22;, callback);
};

/**
* Removes flags for selected message
*
* @param {String} uid Message identifier
* @param {Array} flags Flags to remove from a message
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.inbox.IMAPClient.prototype.updateLabels" id="apidoc.element.inbox.IMAPClient.prototype.updateLabels">
        function <span class="apidocSignatureSpan">inbox.IMAPClient.prototype.</span>updateLabels
        <span class="apidocSignatureSpan">(uid, labels, updateType, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateLabels = function (uid, labels, updateType, callback){
    labels = [].concat(labels || []);

    if(!callback &#x26;&#x26; typeof updateType == &#x22;function&#x22;){
        callback = updateType;
        updateType = undefined;
    }

    updateType = (updateType || &#x22;&#x22;).toString().trim();

    if(!uid){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;Invalid UID value&#x22;));
        }
        return;
    }

    if(!Array.isArray(labels)){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;Invalid labels value&#x22;));
        }
        return;
    }

    if(this._currentState != this.states.SELECTED){
        if(typeof callback == &#x22;function&#x22;){
            callback(new Error(&#x22;No mailbox selected&#x22;));
        }
        return;
    }

    this._send(&#x22;UID STORE &#x22;+uid+&#x22; &#x22;+updateType+&#x22;X-GM-LABELS (&#x22; + labels.join(&#x22; &#x22;) + &#x22;)&#x22;,
      (function(status){
        this._collectMailList = false;

        if(typeof callback != &#x22;function&#x22;){
            return;
        }

        if(typeof callback == &#x22;function&#x22;){
            if(status == &#x22;OK&#x22;){
                if(!this._mailList.length){
                    callback(null, true);
                }else{
                    callback(null, this._mailList[0].labels || []);
                }
            }else{
                callback(new Error(&#x22;Error setting labels&#x22;));
            }
        }

    }).bind(this),
    (function(){
        this._collectMailList = true;
        this._mailList = [];
    }).bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @param {String} uid Message identifier
* @param {Array} labels Labels to set for a message
* @param {Function} callback Callback function to run, returns an array of labels
*/
IMAPClient.prototype.addLabels = function(uid, labels, callback){
   labels = [].concat(labels || []);
   this.<span class="apidocCodeKeywordSpan">updateLabels</span>(uid, labels, &#x22;+&#x22;, callback);
};

/**
* Removes labels for selected message
*
* @param {String} uid Message identifier
* @param {Array} labels Labels to remove from a message
...</pre></li>
    </ul>












</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
